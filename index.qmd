---
# title: Scientific Discovery using Representation Learning to Interpret the Largest Cosmological Simulations
title: Representation Learning with Spherinator
subtitle: High-Performance Computing Visualization
author: Bernd Doser (HITS)
date: 2025/05/14
date-format: "MMMM YYYY"
# institute: "[HITS gGmbH](https://h-its.org)"
title-slide-attributes:
  data-background-image: images/SPACE_title_slide.png
format:
  revealjs:
    logo: images/HITS_RGB_eng.jpg
    footer: "Spherinator & HiPSter (B. Doser)"
    slide-number: true
    highlight-style: a11y
    bibliography: references.bib
    width: 1300
    template-partials:
      - title-slide.html
---

## Outline {background-image="images/aladin-lite-background.png"}

- **Project X**: The Big Picture
- **PEST**: Data Preprocessing
- **Spherinator**: The Training
- **HiPSter**: The Inference
- **Gaia XP DR3 spectra**: Example for 1D spectra data
- **Flyte** and **StreamFlow**: Workflow Orchestration


## Associated Materials

- This presentation with the Jupyter notebooks are publicly available at
  [GitHub](https://github.com/BerndDoser/SPACE_HPC_Visualization_Workshop).

- User guides and documentation are available at
  [ReadTheDocs](https://spherinator.readthedocs.io/en/latest/index.html).

- [PEST](https://github.com/HITS-AIN/PEST): Data acquisition and preprocessing
- [Spherinator](https://github.com/HITS-AIN/Spherinator): Representation Learning using PyTorch Lightning
- [HiPSter](https://github.com/HITS-AIN/HiPSter): Generation of HiPS maps and catalogs


## Project X: The Big Picture

![](images/projectx_v2.png){.absolute left=0 width=1800}


## PEST: Data Preprocessing

- [PEST](https://github.com/HITS-AIN/PEST) preprocess 3D simulation data into multi-channel images, data cubes, and point clouds
- **Parquet** as uniform file format for different data structures
  - Efficient storage by columnar data format
  - Fast access by Apache Arrow


## Spherinator: The Training

- [Spherinator](https://github.com/HITS-AIN/Spherinator)

- Representation learning by **dimensionality reduction**
- **Convolutional Variational Autoencoder** (VAE)
![](images/vae.svg){width="600"}
- **(Hyper-)spherical** latent space

::: aside
Source: [@Polsterer2024], [@Doser2025]
:::


## Power Spherical Distribution

$$\begin{aligned}
p_{X}(x; \mu, \kappa) = N_{X}(\kappa, d)^{-1}(1 + \mu^{\top}x)^{\kappa}
\end{aligned}$$


:::: {.columns}

::: {.column width="40%"}
$d$: Dimension

$\mu$: Direction

$\kappa$: Concentration

$N_{X}$: Normalization factor
:::

::: {.column width="60%"}
![](images/power_spherical.png)
:::

::::

::: aside
Source: [@DeCao2020]
:::


## Spherinator: Demo Part I

[Spherinator demo using Illustris TNG](./demo_spherinator_illustris.ipynb)


## HiPSter: The Inference

HiPS - Hierarchical Progressive Survey

![](images/HEALPix.png){width="700"}

- The HiPS tiles are reconstructed with the corresponding spherical latent space position.

- The HiPS tilings are visualized with [Aladin-Lite](https://github.com/cds-astro/aladin-lite).

::: aside
Source: [@Fernique_2015]
:::

## HiPSter: Demo Part II

[HiPSter demo using Illustris TNG](./demo_hipster_illustris.ipynb)


## Gaia DR3 XP spectra

::: {layout='[1,1]'}
::: n1
::: {style="font-size: 80%;"}
[Gaia DR3 XP](http://cdn.gea.esac.esa.int/Gaia/gdr3/) 
contains over 200 billions blue (BP) and red (RP) spectra as continuous spectra with 55 parameters per spectrum.
![](images/calibrated_spectrum_plot.png){width="600"}


:::
:::
::: n2
```{=html}
<iframe width="600" height="600" src="https://space.h-its.org" title="Webpage example"></iframe>
```
:::
:::


## Summary and Outlook

- Spherinator & HiPSter promising solution for classifying large datasets
- Easy feature extension due to **modern software development techniques**
- Evaluation of encoder, decoder, loss function for better reconstruction
- **Orchestration** of the HiPSter workflow
- **Geometric Deep Learning**: 3D point clouds instead of images
- [Prototype](https://space.h-its.org) and [source code](https://github.com/HITS-AIN/Spherinator) are publicly available


## Acknowledgement & Disclaimer {background-image="images/SPACE_acknowledgement_background.png"}


## References
